{"is_source_file": true, "format": "TypeScript", "description": "This file defines a simple API client for the Furniro frontend, handling API calls with support for base URL configuration, authorization via Bearer token, query parameters, and JSON response parsing. It includes functions for authentication, product catalog, shopping cart, and order management.", "external_files": ["fetch", "process.env", "URL", "HeadersInit", "RequestInit"], "external_methods": ["fetch", "console.warn"], "published": ["setTokenGetter", "api"], "classes": [], "methods": [{"name": "export function setTokenGetter(getter: TokenGetter) { setTokenGetter", "description": "Configures a function that returns the current Bearer token (or null).", "scope": "", "scopeKind": ""}, {"name": "export async function apiFetch<T = unknown>( apiFetch", "description": "Performs an HTTP fetch with base URL, JSON handling, optional authorization, and query serialization.", "scope": "", "scopeKind": ""}, {"name": "register", "description": "Registers a new user account with email, password, and optional name."}, {"name": "login", "description": "Logs in a user with email and password, returning a token and user info."}, {"name": "me", "description": "Retrieves current authenticated user info."}, {"name": "products", "description": "Fetches paginated list of products with optional query parameters."}, {"name": "product", "description": "Fetches a single product by ID or slug."}, {"name": "categories", "description": "Retrieves list of product categories."}, {"name": "getCart", "description": "Gets current user's cart items."}, {"name": "addToCart", "description": "Adds a product to the cart with specified quantity."}, {"name": "updateCart", "description": "Updates quantity of a specific cart item."}, {"name": "removeCartItem", "description": "Removes a product from the cart."}, {"name": "clearCart", "description": "Clears all items from the cart."}, {"name": "createOrder", "description": "Creates a new order, optionally from cart or specific items."}, {"name": "myOrders", "description": "Retrieves current user's orders."}, {"name": "orderById", "description": "Fetches details of a specific order by ID."}, {"name": "allOrders", "description": "Fetches all orders (likely admin)."}, {"name": "createProduct", "description": "Creates a new product (admin)."}, {"name": "updateProduct", "description": "Updates an existing product by ID (admin)."}, {"name": "deleteProduct", "description": "Deletes a product by ID (admin)."}], "calls": ["fetch", "console.warn", "URL", "headers", "JSON.stringify", "JSON.parse", "res.headers.get", "res.json", "res.text"], "search-terms": ["apiFetch", "setTokenGetter", "api", "auth", "Base URL", "authorization header", "fetch wrapper", "product", "cart", "order"], "state": 2, "file_id": 12, "knowledge_revision": 75, "git_revision": "", "revision_history": [{"26": ""}, {"75": ""}], "ctags": [{"_type": "tag", "name": "BASE", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^const BASE = (process.env.NEXT_PUBLIC_API_BASE || \"\").replace(\\/\\\\\\/+$\\/, \"\");$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "FetchOptions", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^export type FetchOptions = RequestInit & {$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "LoginResponse", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^type LoginResponse = { token: string; user?: Record<string, unknown> };$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "Paginated", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^type Paginated<T> = { items: T[]; total?: number; page?: number; pageSize?: number };$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "TokenGetter", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^type TokenGetter = () => string | null;$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "api", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^export const api = {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "apiFetch", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^export async function apiFetch<T = unknown>($/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "contentType", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^  const contentType = res.headers.get(\"content-type\") || \"\";$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^      const data: { message?: string; error?: string } = await res.json();$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^      const data: { message?: string; error?: string } = await res.json();$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^  const headers: HeadersInit = {$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "k", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^    for (const [k, v] of Object.entries(options.query)) {$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "needsJson", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^  const needsJson =$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^  const res = await fetch(url.toString(), {$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "setTokenGetter", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^export function setTokenGetter(getter: TokenGetter) {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^    const token = tokenGetter();$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "tokenGetter", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^let tokenGetter: TokenGetter | null = null;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^  const url = new URL(`${BASE}${path}`);$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}, {"_type": "tag", "name": "v", "path": "/home/kavia/workspace/code-generation/furniro-e-commerce-platform-186157-186167/client_frontend/src/lib/api.ts", "pattern": "/^    for (const [k, v] of Object.entries(options.query)) {$/", "language": "TypeScript", "kind": "constant", "scope": "apiFetch", "scopeKind": "function"}], "hash": "4ee6b523424f29b81274e4201ec3fdaa", "format-version": 4, "code-base-name": "client_frontend", "filename": "client_frontend/src/lib/api.ts", "fields": [{"name": "let tokenGetter: TokenGetter | null = null;", "scope": "", "scopeKind": "", "description": "unavailable"}]}